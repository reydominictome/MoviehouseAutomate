<!DOCTYPE html> 
<html lang="en">
	<head>
		{% load static %}
		<meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1">
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700">
		<title>Registration</title>
		
		<link href="{% static 'css/style.css' %}" rel="stylesheet" type="text/css">
		<link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet" type="text/css">
		<link href="{% static 'css/CustomerStyles.css' %}" rel="stylesheet" type="text/css">
	</head>

	<body class="body-color">
		<nav class="navbar navbar-dark bg-dark">
			<a class="navbar-brand" href="/main">
		    <img src="{% static 'images/icon.png' %} " width="40" height="30" class="d-inline-block align-top" alt="" loading="lazy">
		    Movie House Automate
		  </a>
		</nav>
		<div class="registration-body-left">
			<div class="back-button">
				<a type="submit" href="/customer/index" class="btn btn-success btn-lg">To Report Summary</a>
			</div>
			<div class="signup-form">
			    <form action="" method="POST" enctype="multipart/form-data">
					{% csrf_token %}
					<h2>Register</h2>
			        <table class="a">
			        	<tr>
			        		<td>Date Registered:</td>
							<td><div class="form-group"><input type="date" id="date_registered"
								class="form-control" name="date_registered" 
								placeholder="MM/DD/YYYY" readonly></div></td>
			        	</tr>
			        	<tr><td>&nbsp;</td></tr>
			        	<tr>
			        		<td>Name:</td>
			        		<td><div class="form-group"><input id="first_name" type="text" max="50" class="form-control" name="first_name" placeholder="First Name" required="required"></div>
			        		<div class="form-group"><input id="middle_name" type="text" max="50" class="form-control" name="middle_name" placeholder="Middle Name"></div>
			        		<div class="form-group"><input id="last_name" type="text" max="50" class="form-control" name="last_name" placeholder="Last Name" required="required"></div></td>
			        	</tr>
			        	<tr><td>&nbsp;</td></tr>
			        	<tr>
			        		<td>Address:</td>
			            	<td>
		            			<table class="a">
		            				<tr>
		            					<td><div class="form-group"><input id="street" type="text" max="50" class="form-control" name="street" placeholder="Street" required="required"></div></td>
		            					<td><div class="form-group"><input id="barangay" type="text" max="50" class="form-control" name="barangay" placeholder="Barangay" required="required"></div></td>
		            				</tr>
		            				<tr>
		            					<td><div class="form-group"><input id="province" type="text" max="50" class="form-control" name="province" placeholder="Province" required="required"></div></td>
		            					<td><div class="form-group"><input id="city" type="text" max="50" class="form-control" name="city" placeholder="City" required="required"></div></td>
		            				
		            				</tr>
		            				<tr>
		            					<td><div class="form-group"><input id="state" type="text" max="50" class="form-control" name="state" placeholder="State" required="required"></div></td>
		            					<td><div class="form-group"><input id="zip" type="number" pattern="[\d*]" step="1" class="form-control" name="zip" placeholder="Zip" required="required"></div></td>
		            				</tr>
		            			</table>
			            	</td>
			        	</tr>
			        	<tr><td>&nbsp;</td></tr>
			        	<tr>
			        		<td>Birthdate:</td>
			            	<td><div class="form-group"><input id="birth_date" type="date" class="form-control" name="birth_date" placeholder="mm/dd/yyyy" required="required"></div></td>
			        	</tr>
			        	<tr>
			        		<td>Status:</td>
			            	<td><div class="form-group">
			            		<select id="status" name="status" class="a" name="status">
			            			<option value = "Single">Single</option>
			            			<option value = "Married">Married</option>
			            			<option value = "Divorced">Divorced</option>
			            			<option value = "Widowed">Widowed</option>
			            		</select>
			            	</div></td>
			        	</tr>
			        	<tr>
			        		<td>Gender:</td>
			            	<td><div class="form-group">
			            		<select id="gender" name="gender" class="a" name="gender">
			            			<option value = "Male">Male</option>
			            			<option value = "Female">Female</option>
			            		</select>
			            	</div></td>
			        	</tr>
			        	<tr>
			        		<td>Spouse's Name:</td>
			           		<td><div class="form-group"><input id="spouse_name" type="text" max="50" class="form-control" name="spouse_name" placeholder="First name, Middle Name, Last Name / None"></div></td>
			        	</tr>
			        	<tr>
			        		<td>Spouse's Occupation:</td>
			            	<td><div class="form-group"><input id="spouse_occupation" type="text" max="50" class="form-control" name="spouse_occupation" placeholder="None"></div></td>
			        	</tr>
			        	<tr>
			        		<td>No. of Children:</td>
							<td><div class="form-group"><input id="no_of_children" type="number" 
								step="1" min="0" max="30" pattern="[\d*]" class="form-control" name="no_of_children" value="0" placeholder="0" required></div></td>
			        	</tr>
			        	<tr><td>&nbsp;</td></tr>
			        	<tr>
			        		<td>
								Profile Picture:
			        		</td>
			        		<td>
			        			<div id="wrapper" class="text-left">
										<input id="fileName" type="file" accept="image/*" name="profile_picture" onchange="preview_image(event)">
									<br>
									<div class="image-out">
										<img id = "output_image" src = "{% static 'images/default-cust.png' %}"/>
									</div>
								</div>
			        		</td>
			        	</tr>
			        </table>

					<div class="form-group">
			            <button type="submit" class="btn btn-success btn-lg btn-block">Register</button>
			        </div>
			    </form>

			</div>
		</div>

		<div class="modal" id="message" role="dialog">
			<div class="modal-dialog">
	  
			  <!--MODAL CONTENT-->
			  <div class="modal-content">
				<div class="modal-header">
				  <h4 class="modal-title">Notification</h4>
				  <button type="button" class="close" data-dismiss="modal">&times;</button>
				</div>
				<div class="modal-body" style="overflow-y:hidden;">
				{% for message in messages %}
				  <p>
					{% autoescape off %}
					{{ message }}
					{% endautoescape %}
				  </p>
				{% endfor %}
				</div>
				<div class="modal-footer">
				  <button type="button" class="btn btn-success btn-sm" data-dismiss="modal">Confirm</button>
				</div>
			  </div>
	  
			</div>
		  </div>

		  <div class="modal" id="img-alert" role="dialog">
			<div class="modal-dialog">
	  
			  <!--MODAL CONTENT-->
			  <div class="modal-content">
				<div class="modal-header">
				  <h4 class="modal-title">Notification</h4>
				  <button type="button" class="close" data-dismiss="modal">&times;</button>
				</div>
				<div class="modal-body" style="overflow-y:hidden;">
				  <p>
					Please input an image. (JPG, JPEG, PNG)
				  </p>
				</div>
				<div class="modal-footer">
				  <button type="button" class="btn btn-success btn-sm" data-dismiss="modal">Confirm</button>
				</div>
			  </div>
	  
			</div>
		  </div>
	</body>

	
	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
	<script type='text/javascript'>
		function preview_image(event) 
		{
			var fileName = document.getElementById('fileName').value;
			var idxDot = fileName.lastIndexOf('.') + 1;
			var extFile = fileName.substr(idxDot, fileName.length).toLowerCase();
			if (extFile=='jpg' || extFile=='jpeg' || extFile=='png'){
				{
				var reader = new FileReader();
				reader.onload = function()
				{
					var output = document.getElementById('output_image');
					output.src = reader.result;
				}
				reader.readAsDataURL(event.target.files[0]);
				}
			}else{
				$('#img-alert').modal('show');
				document.getElementById('fileName').value = '';
				document.getElementById('output_image').value = '';
				document.getElementById('output_image').src = "{% static 'images/default-cust.png' %}";
			}   
		}

		$(document).ready(function () {
			var currDate = new Date();
			var day = ("0" + currDate.getDate()).slice(-2);
			var month = ("0" + (currDate.getMonth() + 1)).slice(-2);
			var today = currDate.getFullYear()+"-"+(month)+"-"+(day) ;
			document.getElementById('date_registered').value = today;
		})
	</script>

	<!-- MODAL SCRIPT -->
    <script>
		// Get the button that opens the modal
		var btn = document.querySelectorAll("button.modal-button");

		// All page modals
		var modals = document.querySelectorAll('.modal');

		// Get the <span> element that closes the modal
		var spans = document.getElementsByClassName("close");

		// Get the cancel buttons that closes the modal
		var btnCancel = document.getElementsByClassName("cancel");

		// When the user clicks the button, open the modal
		for (var i = 0; i < btn.length; i++) {
		btn[i].onclick = function(e) {
			e.preventDefault();
			modal = document.querySelector(e.target.getAttribute("href"));
			modal.style.display = "block";
			}
		}

		// When the user clicks on cancel button, close the modal
		for (var i = 0; i < btnCancel.length; i++) {
		btnCancel[i].onclick = function() {
			for (var index in modals) {
			if (typeof modals[index].style !== 'undefined') modals[index].style.display = "none";    
			}
			}
		}

		// When the user clicks on <span> (x), close the modal
		for (var i = 0; i < spans.length; i++) {
		spans[i].onclick = function() {
			for (var index in modals) {
			if (typeof modals[index].style !== 'undefined') modals[index].style.display = "none";    
				}
			}
		}

		// When the user clicks anywhere outside of the modal, close it
		window.onclick = function(event) {
			if (event.target.classList.contains('modal')) {
			for (var index in modals) {
			if (typeof modals[index].style !== 'undefined') modals[index].style.display = "none";    
				}
			}
		}
	</script>

	{% if messages %}
	<script>
	$(document).ready(function(){
		$("#message").modal('show');
	});
	</script>
	{% endif %}
</html>